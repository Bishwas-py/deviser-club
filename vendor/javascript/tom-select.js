var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var t={};(function(e,i){t=i()})(0,(function(){function forEvents(e,t){e.split(/\s+/).forEach((e=>{t(e)}))}class MicroEvent{constructor(){this._events=void 0;this._events={}}on(e,t){forEvents(e,(e=>{this._events[e]=this._events[e]||[];this._events[e].push(t)}))}off(e,t){var i=arguments.length;0!==i?forEvents(e,(e=>{if(1===i)return delete this._events[e];e in this._events!==false&&this._events[e].splice(this._events[e].indexOf(t),1)})):this._events={}}trigger(e,...t){var i=this;forEvents(e,(e=>{if(e in i._events!==false)for(let s of i._events[e])s.apply(i,t)}))}}function MicroPlugin(e){e.plugins={};return class extends e{constructor(...e){super(...e);this.plugins={names:[],settings:{},requested:{},loaded:{}}}
    /**
     * Registers a plugin.
     *
     * @param {function} fn
     */static define(t,i){e.plugins[t]={name:t,fn:i}}
    /**
     * Initializes the listed plugins (with options).
     * Acceptable formats:
     *
     * List (without options):
     *   ['a', 'b', 'c']
     *
     * List (with options):
     *   [{'name': 'a', options: {}}, {'name': 'b', options: {}}]
     *
     * Hash (with options):
     *   {'a': { ... }, 'b': { ... }, 'c': { ... }}
     *
     * @param {array|object} plugins
     */initializePlugins(e){var t,i;const s=this;const n=[];if(Array.isArray(e))e.forEach((e=>{if("string"===typeof e)n.push(e);else{s.plugins.settings[e.name]=e.options;n.push(e.name)}}));else if(e)for(t in e)if(e.hasOwnProperty(t)){s.plugins.settings[t]=e[t];n.push(t)}while(i=n.shift())s.require(i)}loadPlugin(t){var i=this;var s=i.plugins;var n=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');s.requested[t]=true;s.loaded[t]=n.fn.apply(i,[i.plugins.settings[t]||{}]);s.names.push(t)}require(e){var t=this;var i=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(i.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return i.loaded[e]}}}var t;const i="[̀-ͯ·ʾ]";const s=new RegExp(i,"gu");var n;const o={"æ":"ae","ⱥ":"a","ø":"o"};const r=new RegExp(Object.keys(o).join("|"),"gu");const l=[[0,65535]];const asciifold=e=>e.normalize("NFKD").replace(s,"").toLowerCase().replace(r,(function(e){return o[e]}));const arrayToPattern=(e,t="|")=>{if(1==e.length)return e[0];var i=1;e.forEach((e=>{i=Math.max(i,e.length)}));return 1==i?"["+e.join("")+"]":"(?:"+e.join(t)+")"};const escapeToPattern=e=>{const t=e.map((e=>escape_regex(e)));return arrayToPattern(t)};const allSubstrings=e=>{if(1===e.length)return[[e]];var t=[];allSubstrings(e.substring(1)).forEach((function(i){var s=i.slice(0);s[0]=e.charAt(0)+s[0];t.push(s);s=i.slice(0);s.unshift(e.charAt(0));t.push(s)}));return t};const generateDiacritics=e=>{var s={};e.forEach((e=>{for(let i=e[0];i<=e[1];i++){let e=String.fromCharCode(i);let n=asciifold(e);if(n!=e.toLowerCase()&&!(n.length>3)){n in s||(s[n]=[n]);var t=new RegExp(escapeToPattern(s[n]),"iu");e.match(t)||s[n].push(e)}}}));let n=Object.keys(s);for(let e=0;e<n.length;e++){const t=n[e];s[t].length<2&&delete s[t]}n=Object.keys(s).sort(((e,t)=>t.length-e.length));t=new RegExp("("+escapeToPattern(n)+i+"*)","gu");var o={};n.sort(((e,t)=>e.length-t.length)).forEach((e=>{var t=allSubstrings(e);var i=t.map((e=>{e=e.map((e=>s.hasOwnProperty(e)?escapeToPattern(s[e]):e));return arrayToPattern(e,"")}));o[e]=arrayToPattern(i)}));return o};const diacriticRegexPoints=e=>{void 0===n&&(n=generateDiacritics(l));const i=e.normalize("NFKD").toLowerCase();return i.split(t).map((e=>{const t=asciifold(e);return""==t?"":n.hasOwnProperty(t)?n[t]:e})).join("")};
    /**
     * A property getter resolving dot-notation
     * @param  {Object}  obj     The root object to fetch property on
     * @param  {String}  name    The optionally dotted property name to fetch
     * @return {Object}          The resolved property value
     */const getAttr=(e,t)=>{if(e)return e[t]};
    /**
     * A property getter resolving dot-notation
     * @param  {Object}  obj     The root object to fetch property on
     * @param  {String}  name    The optionally dotted property name to fetch
     * @return {Object}          The resolved property value
     */const getAttrNesting=(e,t)=>{if(e){var i,s=t.split(".");while((i=s.shift())&&(e=e[i]));return e}};const scoreValue=(e,t,i)=>{var s,n;if(!e)return 0;e+="";n=e.search(t.regex);if(-1===n)return 0;s=t.string.length/e.length;0===n&&(s+=.5);return s*i};const escape_regex=e=>(e+"").replace(/([\$\(-\+\.\?\[-\^\{-\}])/g,"\\$1");const propToArray=(e,t)=>{var i=e[t];if("function"==typeof i)return i;i&&!Array.isArray(i)&&(e[t]=[i])};const iterate=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)};const cmp=(e,t)=>{if("number"===typeof e&&"number"===typeof t)return e>t?1:e<t?-1:0;e=asciifold(e+"").toLowerCase();t=asciifold(t+"").toLowerCase();return e>t?1:t>e?-1:0};class Sifter{constructor(e,t){this.items=void 0;this.settings=void 0;this.items=e;this.settings=t||{diacritics:true}}tokenize(e,t,i){if(!e||!e.length)return[];const s=[];const n=e.split(/\s+/);var o;i&&(o=new RegExp("^("+Object.keys(i).map(escape_regex).join("|")+"):(.*)$"));n.forEach((e=>{let i;let n=null;let r=null;if(o&&(i=e.match(o))){n=i[1];e=i[2]}if(e.length>0){r=this.settings.diacritics?diacriticRegexPoints(e):escape_regex(e);t&&(r="\\b"+r)}s.push({string:e,regex:r?new RegExp(r,"iu"):null,field:n})}));return s}
        /**
         * Returns a function to be used to score individual results.
         *
         * Good matches will have a higher score than poor matches.
         * If an item is not a match, 0 will be returned by the function.
         *
         * @returns {function}
         */getScoreFunction(e,t){var i=this.prepareSearch(e,t);return this._getScoreFunction(i)}_getScoreFunction(e){const t=e.tokens,i=t.length;if(!i)return function(){return 0};const s=e.options.fields,n=e.weights,o=s.length,r=e.getAttrFn;if(!o)return function(){return 1};const l=function(){return 1===o?function(e,t){const i=s[0].field;return scoreValue(r(t,i),e,n[i])}:function(e,t){var i=0;if(e.field){const s=r(t,e.field);!e.regex&&s?i+=1/o:i+=scoreValue(s,e,1)}else iterate(n,((s,n)=>{i+=scoreValue(r(t,n),e,s)}));return i/o}}();return 1===i?function(e){return l(t[0],e)}:"and"===e.options.conjunction?function(e){var s,n=0,o=0;for(;n<i;n++){s=l(t[n],e);if(s<=0)return 0;o+=s}return o/i}:function(e){var s=0;iterate(t,(t=>{s+=l(t,e)}));return s/i}}getSortFunction(e,t){var i=this.prepareSearch(e,t);return this._getSortFunction(i)}_getSortFunction(e){var t,i,s;const n=this,o=e.options,r=!e.query&&o.sort_empty?o.sort_empty:o.sort,l=[],a=[];if("function"==typeof r)return r.bind(this);const c=function get_field(t,i){return"$score"===t?i.score:e.getAttrFn(n.items[i.id],t)};if(r)for(t=0,i=r.length;t<i;t++)(e.query||"$score"!==r[t].field)&&l.push(r[t]);if(e.query){s=true;for(t=0,i=l.length;t<i;t++)if("$score"===l[t].field){s=false;break}s&&l.unshift({field:"$score",direction:"desc"})}else for(t=0,i=l.length;t<i;t++)if("$score"===l[t].field){l.splice(t,1);break}for(t=0,i=l.length;t<i;t++)a.push("desc"===l[t].direction?-1:1);const d=l.length;if(d){if(1===d){const e=l[0].field;const t=a[0];return function(i,s){return t*cmp(c(e,i),c(e,s))}}return function(e,t){var i,s,n;for(i=0;i<d;i++){n=l[i].field;s=a[i]*cmp(c(n,e),c(n,t));if(s)return s}return 0}}return null}prepareSearch(e,t){const i={};var s=Object.assign({},t);propToArray(s,"sort");propToArray(s,"sort_empty");if(s.fields){propToArray(s,"fields");const e=[];s.fields.forEach((t=>{"string"==typeof t&&(t={field:t,weight:1});e.push(t);i[t.field]="weight"in t?t.weight:1}));s.fields=e}return{options:s,query:e.toLowerCase().trim(),tokens:this.tokenize(e,s.respect_word_boundaries,i),total:0,items:[],weights:i,getAttrFn:s.nesting?getAttrNesting:getAttr}}search(e,t){var i,s,n=this;s=this.prepareSearch(e,t);t=s.options;e=s.query;const o=t.score||n._getScoreFunction(s);e.length?iterate(n.items,((e,n)=>{i=o(e);(false===t.filter||i>0)&&s.items.push({score:i,id:n})})):iterate(n.items,((e,t)=>{s.items.push({score:1,id:t})}));const r=n._getSortFunction(s);r&&s.items.sort(r);s.total=s.items.length;"number"===typeof t.limit&&(s.items=s.items.slice(0,t.limit));return s}}const getDom=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(isHtmlString(e)){let t=document.createElement("div");t.innerHTML=e.trim();return t.firstChild}return document.querySelector(e)};const isHtmlString=e=>"string"===typeof e&&e.indexOf("<")>-1;const escapeQuery=e=>e.replace(/['"\\]/g,"\\$&");const triggerEvent=(e,t)=>{var i=document.createEvent("HTMLEvents");i.initEvent(t,true,false);e.dispatchEvent(i)};const applyCSS=(e,t)=>{Object.assign(e.style,t)};const addClasses=(e,...t)=>{var i=classesArray(t);e=castAsArray(e);e.map((e=>{i.map((t=>{e.classList.add(t)}))}))};const removeClasses=(e,...t)=>{var i=classesArray(t);e=castAsArray(e);e.map((e=>{i.map((t=>{e.classList.remove(t)}))}))};const classesArray=e=>{var t=[];iterate(e,(e=>{"string"===typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/));Array.isArray(e)&&(t=t.concat(e))}));return t.filter(Boolean)};const castAsArray=e=>{Array.isArray(e)||(e=[e]);return e};const parentMatch=(e,t,i)=>{if(!i||i.contains(e))while(e&&e.matches){if(e.matches(t))return e;e=e.parentNode}};const getTail=(e,t=0)=>t>0?e[e.length-1]:e[0];const isEmptyObject=e=>0===Object.keys(e).length;const nodeIndex=(e,t)=>{if(!e)return-1;t=t||e.nodeName;var i=0;while(e=e.previousElementSibling)e.matches(t)&&i++;return i};const setAttr=(e,t)=>{iterate(t,((t,i)=>{null==t?e.removeAttribute(i):e.setAttribute(i,""+t)}))};const replaceNode=(e,t)=>{e.parentNode&&e.parentNode.replaceChild(t,e)};const highlight=(e,t)=>{if(null===t)return;if("string"===typeof t){if(!t.length)return;t=new RegExp(t,"i")}const highlightText=e=>{var i=e.data.match(t);if(i&&e.data.length>0){var s=document.createElement("span");s.className="highlight";var n=e.splitText(i.index);n.splitText(i[0].length);var o=n.cloneNode(true);s.appendChild(o);replaceNode(n,s);return 1}return 0};const highlightChildren=e=>{if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&("highlight"!==e.className||"SPAN"!==e.tagName))for(var t=0;t<e.childNodes.length;++t)t+=highlightRecursive(e.childNodes[t])};const highlightRecursive=e=>{if(3===e.nodeType)return highlightText(e);highlightChildren(e);return 0};highlightRecursive(e)};const removeHighlight=e=>{var t=e.querySelectorAll("span.highlight");Array.prototype.forEach.call(t,(function(e){var t=e.parentNode;t.replaceChild(e.firstChild,e);t.normalize()}))};const a=65;const c=13;const d=27;const u=37;const p=38;const h=39;const g=40;const f=8;const v=46;const m=9;const O="undefined"!==typeof navigator&&/Mac/.test(navigator.userAgent);const y=O?"metaKey":"ctrlKey";var b={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:true,diacritics:true,create:null,createOnBlur:false,createFilter:null,highlight:true,openOnFocus:true,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:false,addPrecedence:false,selectOnTab:false,preload:null,allowEmptyOption:false,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:false,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:false,placeholder:null,hidePlaceholder:null,shouldLoad:function(e){return e.length>0},render:{}};const hash_key=e=>"undefined"===typeof e||null===e?null:get_hash(e);const get_hash=e=>"boolean"===typeof e?e?"1":"0":e+"";const escape_html=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");const loadDebounce=(t,i)=>{var s;return function(n,o){var r=this||e;if(s){r.loading=Math.max(r.loading-1,0);clearTimeout(s)}s=setTimeout((function(){s=null;r.loadedSearches[n]=true;t.call(r,n,o)}),i)}};const debounce_events=(e,t,i)=>{var s;var n=e.trigger;var o={};e.trigger=function(){var i=arguments[0];if(-1===t.indexOf(i))return n.apply(e,arguments);o[i]=arguments};i.apply(e,[]);e.trigger=n;for(s of t)s in o&&n.apply(e,o[s])};const getSelection=e=>({start:e.selectionStart||0,length:(e.selectionEnd||0)-(e.selectionStart||0)});const preventDefault=(e,t=false)=>{if(e){e.preventDefault();t&&e.stopPropagation()}};const addEvent=(e,t,i,s)=>{e.addEventListener(t,i,s)};const isKeyDown=(e,t)=>{if(!t)return false;if(!t[e])return false;var i=(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0);return 1===i};const getId=(e,t)=>{const i=e.getAttribute("id");if(i)return i;e.setAttribute("id",t);return t};const addSlashes=e=>e.replace(/[\\"']/g,"\\$&");const append=(e,t)=>{t&&e.append(t)};function getSettings(e,t){var i=Object.assign({},b,t);var s=i.dataAttr;var n=i.labelField;var o=i.valueField;var r=i.disabledField;var l=i.optgroupField;var a=i.optgroupLabelField;var c=i.optgroupValueField;var d=e.tagName.toLowerCase();var u=e.getAttribute("placeholder")||e.getAttribute("data-placeholder");if(!u&&!i.allowEmptyOption){let t=e.querySelector('option[value=""]');t&&(u=t.textContent)}var p={placeholder:u,options:[],optgroups:[],items:[],maxItems:null};var init_select=()=>{var t;var d=p.options;var u={};var h=1;var readData=e=>{var t=Object.assign({},e.dataset);var i=s&&t[s];"string"===typeof i&&i.length&&(t=Object.assign(t,JSON.parse(i)));return t};var addOption=(e,t)=>{var s=hash_key(e.value);if(null!=s&&(s||i.allowEmptyOption)){if(u.hasOwnProperty(s)){if(t){var a=u[s][l];a?Array.isArray(a)?a.push(t):u[s][l]=[a,t]:u[s][l]=t}}else{var c=readData(e);c[n]=c[n]||e.textContent;c[o]=c[o]||s;c[r]=c[r]||e.disabled;c[l]=c[l]||t;c.$option=e;u[s]=c;d.push(c)}e.selected&&p.items.push(s)}};var addGroup=e=>{var t,i;i=readData(e);i[a]=i[a]||e.getAttribute("label")||"";i[c]=i[c]||h++;i[r]=i[r]||e.disabled;p.optgroups.push(i);t=i[c];iterate(e.children,(e=>{addOption(e,t)}))};p.maxItems=e.hasAttribute("multiple")?null:1;iterate(e.children,(e=>{t=e.tagName.toLowerCase();"optgroup"===t?addGroup(e):"option"===t&&addOption(e)}))};var init_textbox=()=>{const t=e.getAttribute(s);if(t){p.options=JSON.parse(t);iterate(p.options,(e=>{p.items.push(e[o])}))}else{var r=e.value.trim()||"";if(!i.allowEmptyOption&&!r.length)return;const t=r.split(i.delimiter);iterate(t,(e=>{const t={};t[n]=e;t[o]=e;p.options.push(t)}));p.items=t}};"select"===d?init_select():init_textbox();return Object.assign({},b,p,t)}var w=0;class TomSelect extends(MicroPlugin(MicroEvent)){constructor(e,t){super();this.control_input=void 0;this.wrapper=void 0;this.dropdown=void 0;this.control=void 0;this.dropdown_content=void 0;this.focus_node=void 0;this.order=0;this.settings=void 0;this.input=void 0;this.tabIndex=void 0;this.is_select_tag=void 0;this.rtl=void 0;this.inputId=void 0;this._destroy=void 0;this.sifter=void 0;this.isOpen=false;this.isDisabled=false;this.isRequired=void 0;this.isInvalid=false;this.isValid=true;this.isLocked=false;this.isFocused=false;this.isInputHidden=false;this.isSetup=false;this.ignoreFocus=false;this.ignoreHover=false;this.hasOptions=false;this.currentResults=void 0;this.lastValue="";this.caretPos=0;this.loading=0;this.loadedSearches={};this.activeOption=null;this.activeItems=[];this.optgroups={};this.options={};this.userOptions={};this.items=[];w++;var i;var s=getDom(e);if(s.tomselect)throw new Error("Tom Select already initialized on this element");s.tomselect=this;var n=window.getComputedStyle&&window.getComputedStyle(s,null);i=n.getPropertyValue("direction");const o=getSettings(s,t);this.settings=o;this.input=s;this.tabIndex=s.tabIndex||0;this.is_select_tag="select"===s.tagName.toLowerCase();this.rtl=/rtl/i.test(i);this.inputId=getId(s,"tomselect-"+w);this.isRequired=s.required;this.sifter=new Sifter(this.options,{diacritics:o.diacritics});o.mode=o.mode||(1===o.maxItems?"single":"multi");"boolean"!==typeof o.hideSelected&&(o.hideSelected="multi"===o.mode);"boolean"!==typeof o.hidePlaceholder&&(o.hidePlaceholder="multi"!==o.mode);var r=o.createFilter;if("function"!==typeof r){"string"===typeof r&&(r=new RegExp(r));r instanceof RegExp?o.createFilter=e=>r.test(e):o.createFilter=e=>this.settings.duplicates||!this.options[e]}this.initializePlugins(o.plugins);this.setupCallbacks();this.setupTemplates();const l=getDom("<div>");const a=getDom("<div>");const c=this._render("dropdown");const d=getDom('<div role="listbox" tabindex="-1">');const u=this.input.getAttribute("class")||"";const p=o.mode;var h;addClasses(l,o.wrapperClass,u,p);addClasses(a,o.controlClass);append(l,a);addClasses(c,o.dropdownClass,p);o.copyClassesToDropdown&&addClasses(c,u);addClasses(d,o.dropdownContentClass);append(c,d);getDom(o.dropdownParent||l).appendChild(c);if(isHtmlString(o.controlInput)){h=getDom(o.controlInput);var g=["autocorrect","autocapitalize","autocomplete"];iterate(g,(e=>{s.getAttribute(e)&&setAttr(h,{[e]:s.getAttribute(e)})}));h.tabIndex=-1;a.appendChild(h);this.focus_node=h}else if(o.controlInput){h=getDom(o.controlInput);this.focus_node=h}else{h=getDom("<input/>");this.focus_node=a}this.wrapper=l;this.dropdown=c;this.dropdown_content=d;this.control=a;this.control_input=h;this.setup()}setup(){const e=this;const t=e.settings;const i=e.control_input;const s=e.dropdown;const n=e.dropdown_content;const o=e.wrapper;const r=e.control;const l=e.input;const a=e.focus_node;const c={passive:true};const d=e.inputId+"-ts-dropdown";setAttr(n,{id:d});setAttr(a,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":d});const u=getId(a,e.inputId+"-ts-control");const p="label[for='"+escapeQuery(e.inputId)+"']";const h=document.querySelector(p);const g=e.focus.bind(e);if(h){addEvent(h,"click",g);setAttr(h,{for:u});const t=getId(h,e.inputId+"-ts-label");setAttr(a,{"aria-labelledby":t});setAttr(n,{"aria-labelledby":t})}o.style.width=l.style.width;if(e.plugins.names.length){const t="plugin-"+e.plugins.names.join(" plugin-");addClasses([o,s],t)}(null===t.maxItems||t.maxItems>1)&&e.is_select_tag&&setAttr(l,{multiple:"multiple"});t.placeholder&&setAttr(i,{placeholder:t.placeholder});!t.splitOn&&t.delimiter&&(t.splitOn=new RegExp("\\s*"+escape_regex(t.delimiter)+"+\\s*"));t.load&&t.loadThrottle&&(t.load=loadDebounce(t.load,t.loadThrottle));e.control_input.type=l.type;addEvent(s,"mouseenter",(t=>{var i=parentMatch(t.target,"[data-selectable]",s);i&&e.onOptionHover(t,i)}),{capture:true});addEvent(s,"click",(t=>{const i=parentMatch(t.target,"[data-selectable]");if(i){e.onOptionSelect(t,i);preventDefault(t,true)}}));addEvent(r,"click",(t=>{var s=parentMatch(t.target,"[data-ts-item]",r);if(s&&e.onItemSelect(t,s))preventDefault(t,true);else if(""==i.value){e.onClick();preventDefault(t,true)}}));addEvent(a,"keydown",(t=>e.onKeyDown(t)));addEvent(i,"keypress",(t=>e.onKeyPress(t)));addEvent(i,"input",(t=>e.onInput(t)));addEvent(a,"resize",(()=>e.positionDropdown()),c);addEvent(a,"blur",(t=>e.onBlur(t)));addEvent(a,"focus",(t=>e.onFocus(t)));addEvent(i,"paste",(t=>e.onPaste(t)));const doc_mousedown=t=>{const n=t.composedPath()[0];if(o.contains(n)||s.contains(n))n==i&&e.isOpen?t.stopPropagation():preventDefault(t,true);else{e.isFocused&&e.blur();e.inputState()}};const win_scroll=()=>{e.isOpen&&e.positionDropdown()};const win_hover=()=>{e.ignoreHover=false};addEvent(document,"mousedown",doc_mousedown);addEvent(window,"scroll",win_scroll,c);addEvent(window,"resize",win_scroll,c);addEvent(window,"mousemove",win_hover,c);this._destroy=()=>{document.removeEventListener("mousedown",doc_mousedown);window.removeEventListener("mousemove",win_hover);window.removeEventListener("scroll",win_scroll);window.removeEventListener("resize",win_scroll);h&&h.removeEventListener("click",g)};this.revertSettings={innerHTML:l.innerHTML,tabIndex:l.tabIndex};l.tabIndex=-1;l.insertAdjacentElement("afterend",e.wrapper);e.sync(false);t.items=[];delete t.optgroups;delete t.options;addEvent(l,"invalid",(t=>{if(e.isValid){e.isValid=false;e.isInvalid=true;e.refreshState()}}));e.updateOriginalInput();e.refreshItems();e.close(false);e.inputState();e.isSetup=true;l.disabled?e.disable():e.enable();e.on("change",this.onChange);addClasses(l,"tomselected","ts-hidden-accessible");e.trigger("initialize");true===t.preload&&e.preload()}setupOptions(e=[],t=[]){this.addOptions(e);iterate(t,(e=>{this.registerOptionGroup(e)}))}setupTemplates(){var e=this;var t=e.settings.labelField;var i=e.settings.optgroupLabelField;var s={optgroup:e=>{let t=document.createElement("div");t.className="optgroup";t.appendChild(e.options);return t},optgroup_header:(e,t)=>'<div class="optgroup-header">'+t(e[i])+"</div>",option:(e,i)=>"<div>"+i(e[t])+"</div>",item:(e,i)=>"<div>"+i(e[t])+"</div>",option_create:(e,t)=>'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};e.settings.render=Object.assign({},s,e.settings.render)}setupCallbacks(){var e,t;var i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in i){t=this.settings[i[e]];t&&this.on(e,t)}}sync(e=true){const t=this;const i=e?getSettings(t.input,{delimiter:t.settings.delimiter}):t.settings;t.setupOptions(i.options,i.optgroups);t.setValue(i.items||[],true);t.lastQuery=null}onClick(){var e=this;if(e.activeItems.length>0){e.clearActiveItems();e.focus()}else e.isFocused&&e.isOpen?e.blur():e.focus()}
        /**
         * @deprecated v1.7
         *
         */onMouseDown(){}onChange(){triggerEvent(this.input,"input");triggerEvent(this.input,"change")}onPaste(e){var t=this;t.isInputHidden||t.isLocked?preventDefault(e):t.settings.splitOn&&setTimeout((()=>{var e=t.inputValue();if(e.match(t.settings.splitOn)){var i=e.trim().split(t.settings.splitOn);iterate(i,(e=>{e=hash_key(e);this.options[e]?t.addItem(e):t.createItem(e)}))}}),0)}onKeyPress(e){var t=this;if(t.isLocked)preventDefault(e);else{var i=String.fromCharCode(e.keyCode||e.which);if(t.settings.create&&"multi"===t.settings.mode&&i===t.settings.delimiter){t.createItem();preventDefault(e)}else;}}onKeyDown(e){var t=this;t.ignoreHover=true;if(t.isLocked)e.keyCode!==m&&preventDefault(e);else{switch(e.keyCode){case a:if(isKeyDown(y,e)&&""==t.control_input.value){preventDefault(e);t.selectAll();return}break;case d:if(t.isOpen){preventDefault(e,true);t.close()}t.clearActiveItems();return;case g:if(!t.isOpen&&t.hasOptions)t.open();else if(t.activeOption){let e=t.getAdjacent(t.activeOption,1);e&&t.setActiveOption(e)}preventDefault(e);return;case p:if(t.activeOption){let e=t.getAdjacent(t.activeOption,-1);e&&t.setActiveOption(e)}preventDefault(e);return;case c:if(t.canSelect(t.activeOption)){t.onOptionSelect(e,t.activeOption);preventDefault(e)}else(t.settings.create&&t.createItem()||document.activeElement==t.control_input&&t.isOpen)&&preventDefault(e);return;case u:t.advanceSelection(-1,e);return;case h:t.advanceSelection(1,e);return;case m:if(t.settings.selectOnTab){if(t.canSelect(t.activeOption)){t.onOptionSelect(e,t.activeOption);preventDefault(e)}t.settings.create&&t.createItem()&&preventDefault(e)}return;case f:case v:t.deleteSelection(e);return}t.isInputHidden&&!isKeyDown(y,e)&&preventDefault(e)}}onInput(e){var t=this;if(!t.isLocked){var i=t.inputValue();if(t.lastValue!==i){t.lastValue=i;t.settings.shouldLoad.call(t,i)&&t.load(i);t.refreshOptions();t.trigger("type",i)}}}onOptionHover(e,t){this.ignoreHover||this.setActiveOption(t,false)}onFocus(e){var t=this;var i=t.isFocused;if(t.isDisabled){t.blur();preventDefault(e)}else if(!t.ignoreFocus){t.isFocused=true;"focus"===t.settings.preload&&t.preload();i||t.trigger("focus");if(!t.activeItems.length){t.showInput();t.refreshOptions(!!t.settings.openOnFocus)}t.refreshState()}}onBlur(e){if(false!==document.hasFocus()){var t=this;if(t.isFocused){t.isFocused=false;t.ignoreFocus=false;var deactivate=()=>{t.close();t.setActiveItem();t.setCaret(t.items.length);t.trigger("blur")};t.settings.create&&t.settings.createOnBlur?t.createItem(null,false,deactivate):deactivate()}}}onOptionSelect(e,t){var i,s=this;if(!t.parentElement||!t.parentElement.matches("[data-disabled]"))if(t.classList.contains("create"))s.createItem(null,true,(()=>{s.settings.closeAfterSelect&&s.close()}));else{i=t.dataset.value;if("undefined"!==typeof i){s.lastQuery=null;s.addItem(i);s.settings.closeAfterSelect&&s.close();!s.settings.hideSelected&&e.type&&/click/.test(e.type)&&s.setActiveOption(t)}}}canSelect(e){return!!(this.isOpen&&e&&this.dropdown_content.contains(e))}onItemSelect(e,t){var i=this;if(!i.isLocked&&"multi"===i.settings.mode){preventDefault(e);i.setActiveItem(t,e);return true}return false}canLoad(e){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(e)}load(e){const t=this;if(!t.canLoad(e))return;addClasses(t.wrapper,t.settings.loadingClass);t.loading++;const i=t.loadCallback.bind(t);t.settings.load.call(t,e,i)}loadCallback(e,t){const i=this;i.loading=Math.max(i.loading-1,0);i.lastQuery=null;i.clearActiveOption();i.setupOptions(e,t);i.refreshOptions(i.isFocused&&!i.isInputHidden);i.loading||removeClasses(i.wrapper,i.settings.loadingClass);i.trigger("load",e,t)}preload(){var e=this.wrapper.classList;if(!e.contains("preloaded")){e.add("preloaded");this.load("")}}setTextboxValue(e=""){var t=this.control_input;var i=t.value!==e;if(i){t.value=e;triggerEvent(t,"update");this.lastValue=e}}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){var i=t?[]:["change"];debounce_events(this,i,(()=>{this.clear(t);this.addItems(e,t)}))}setMaxItems(e){0===e&&(e=null);this.settings.maxItems=e;this.refreshState()}setActiveItem(e,t){var i=this;var s;var n,o,r,l;var a;if("single"!==i.settings.mode)if(e){s=t&&t.type.toLowerCase();if("click"===s&&isKeyDown("shiftKey",t)&&i.activeItems.length){a=i.getLastActive();o=Array.prototype.indexOf.call(i.control.children,a);r=Array.prototype.indexOf.call(i.control.children,e);if(o>r){l=o;o=r;r=l}for(n=o;n<=r;n++){e=i.control.children[n];-1===i.activeItems.indexOf(e)&&i.setActiveItemClass(e)}preventDefault(t)}else if("click"===s&&isKeyDown(y,t)||"keydown"===s&&isKeyDown("shiftKey",t))e.classList.contains("active")?i.removeActiveItem(e):i.setActiveItemClass(e);else{i.clearActiveItems();i.setActiveItemClass(e)}i.hideInput();i.isFocused||i.focus()}else{i.clearActiveItems();i.isFocused&&i.showInput()}}setActiveItemClass(e){const t=this;const i=t.control.querySelector(".last-active");i&&removeClasses(i,"last-active");addClasses(e,"active last-active");t.trigger("item_select",e);-1==t.activeItems.indexOf(e)&&t.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1);removeClasses(e,"active")}clearActiveItems(){removeClasses(this.activeItems,"active");this.activeItems=[]}setActiveOption(e,t=true){if(e!==this.activeOption){this.clearActiveOption();if(e){this.activeOption=e;setAttr(this.focus_node,{"aria-activedescendant":e.getAttribute("id")});setAttr(e,{"aria-selected":"true"});addClasses(e,"active");t&&this.scrollToOption(e)}}}scrollToOption(e,t){if(!e)return;const i=this.dropdown_content;const s=i.clientHeight;const n=i.scrollTop||0;const o=e.offsetHeight;const r=e.getBoundingClientRect().top-i.getBoundingClientRect().top+n;r+o>s+n?this.scroll(r-s+o,t):r<n&&this.scroll(r,t)}scroll(e,t){const i=this.dropdown_content;t&&(i.style.scrollBehavior=t);i.scrollTop=e;i.style.scrollBehavior=""}clearActiveOption(){if(this.activeOption){removeClasses(this.activeOption,"active");setAttr(this.activeOption,{"aria-selected":null})}this.activeOption=null;setAttr(this.focus_node,{"aria-activedescendant":null})}selectAll(){const e=this;if("single"===e.settings.mode)return;const t=e.controlChildren();if(t.length){e.hideInput();e.close();e.activeItems=t;iterate(t,(t=>{e.setActiveItemClass(t)}))}}inputState(){var e=this;if(e.control.contains(e.control_input)){setAttr(e.control_input,{placeholder:e.settings.placeholder});if(e.activeItems.length>0||!e.isFocused&&e.settings.hidePlaceholder&&e.items.length>0){e.setTextboxValue();e.isInputHidden=true}else{e.settings.hidePlaceholder&&e.items.length>0&&setAttr(e.control_input,{placeholder:""});e.isInputHidden=false}e.wrapper.classList.toggle("input-hidden",e.isInputHidden)}}
        /**
         * Hides the input element out of view, while
         * retaining its focus.
         * @deprecated 1.3
         */hideInput(){this.inputState()}
        /**
         * Restores input visibility.
         * @deprecated 1.3
         */showInput(){this.inputState()}inputValue(){return this.control_input.value.trim()}focus(){var e=this;if(!e.isDisabled){e.ignoreFocus=true;e.control_input.offsetWidth?e.control_input.focus():e.focus_node.focus();setTimeout((()=>{e.ignoreFocus=false;e.onFocus()}),0)}}blur(){this.focus_node.blur();this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings;var t=e.sortField;"string"===typeof e.sortField&&(t=[{field:e.sortField}]);return{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,i,s;var n=this;var o=this.getSearchOptions();if(n.settings.score){s=n.settings.score.call(n,e);if("function"!==typeof s)throw new Error('Tom Select "score" setting must be a function that returns a function')}if(e!==n.lastQuery){n.lastQuery=e;i=n.sifter.search(e,Object.assign(o,{score:s}));n.currentResults=i}else i=Object.assign({},n.currentResults);if(n.settings.hideSelected)for(t=i.items.length-1;t>=0;t--){let e=hash_key(i.items[t].id);e&&-1!==n.items.indexOf(e)&&i.items.splice(t,1)}return i}refreshOptions(e=true){var t,i,s,n,o,r,l,a,c,d;var u;const p={};const h=[];var g=this;var f=g.inputValue();var v=g.search(f);var m=null;var O=g.settings.shouldOpen||false;var y=g.dropdown_content;if(g.activeOption){c=g.activeOption.dataset.value;d=g.activeOption.closest("[data-group]")}n=v.items.length;"number"===typeof g.settings.maxOptions&&(n=Math.min(n,g.settings.maxOptions));n>0&&(O=true);for(t=0;t<n;t++){let e=v.items[t].id;let n=g.options[e];let l=g.getOption(e,true);g.settings.hideSelected||l.classList.toggle("selected",g.items.includes(e));o=n[g.settings.optgroupField]||"";r=Array.isArray(o)?o:[o];for(i=0,s=r&&r.length;i<s;i++){o=r[i];g.optgroups.hasOwnProperty(o)||(o="");if(!p.hasOwnProperty(o)){p[o]=document.createDocumentFragment();h.push(o)}if(i>0){l=l.cloneNode(true);setAttr(l,{id:n.$id+"-clone-"+i,"aria-selected":null});l.classList.add("ts-cloned");removeClasses(l,"active")}m||c!=e||(d?d.dataset.group===o&&(m=l):m=l);p[o].appendChild(l)}}this.settings.lockOptgroupOrder&&h.sort(((e,t)=>{var i=g.optgroups[e]&&g.optgroups[e].$order||0;var s=g.optgroups[t]&&g.optgroups[t].$order||0;return i-s}));l=document.createDocumentFragment();iterate(h,(e=>{if(g.optgroups.hasOwnProperty(e)&&p[e].children.length){let t=document.createDocumentFragment();let i=g.render("optgroup_header",g.optgroups[e]);append(t,i);append(t,p[e]);let s=g.render("optgroup",{group:g.optgroups[e],options:t});append(l,s)}else append(l,p[e])}));y.innerHTML="";append(y,l);if(g.settings.highlight){removeHighlight(y);v.query.length&&v.tokens.length&&iterate(v.tokens,(e=>{highlight(y,e.regex)}))}var add_template=e=>{let t=g.render(e,{input:f});if(t){O=true;y.insertBefore(t,y.firstChild)}return t};g.loading?add_template("loading"):g.settings.shouldLoad.call(g,f)?0===v.items.length&&add_template("no_results"):add_template("not_loading");a=g.canCreate(f);a&&(u=add_template("option_create"));g.hasOptions=v.items.length>0||a;if(O){if(v.items.length>0){!m&&"single"===g.settings.mode&&g.items.length&&(m=g.getOption(g.items[0]));if(!y.contains(m)){let e=0;u&&!g.settings.addPrecedence&&(e=1);m=g.selectable()[e]}}else u&&(m=u);if(e&&!g.isOpen){g.open();g.scrollToOption(m,"auto")}g.setActiveOption(m)}else{g.clearActiveOption();e&&g.isOpen&&g.close(false)}}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e,t=false){const i=this;if(Array.isArray(e)){i.addOptions(e,t);return false}const s=hash_key(e[i.settings.valueField]);if(null===s||i.options.hasOwnProperty(s))return false;e.$order=e.$order||++i.order;e.$id=i.inputId+"-opt-"+e.$order;i.options[s]=e;i.lastQuery=null;if(t){i.userOptions[s]=t;i.trigger("option_add",s,e)}return s}addOptions(e,t=false){iterate(e,(e=>{this.addOption(e,t)}))}
        /**
         * @deprecated 1.7.7
         */registerOption(e){return this.addOption(e)}registerOptionGroup(e){var t=hash_key(e[this.settings.optgroupValueField]);if(null===t)return false;e.$order=e.$order||++this.order;this.optgroups[t]=e;return t}addOptionGroup(e,t){var i;t[this.settings.optgroupValueField]=e;(i=this.registerOptionGroup(t))&&this.trigger("optgroup_add",i,t)}removeOptionGroup(e){if(this.optgroups.hasOwnProperty(e)){delete this.optgroups[e];this.clearCache();this.trigger("optgroup_remove",e)}}clearOptionGroups(){this.optgroups={};this.clearCache();this.trigger("optgroup_clear")}updateOption(e,t){const i=this;var s;var n;const o=hash_key(e);const r=hash_key(t[i.settings.valueField]);if(null===o)return;if(!i.options.hasOwnProperty(o))return;if("string"!==typeof r)throw new Error("Value must be set in option data");const l=i.getOption(o);const a=i.getItem(o);t.$order=t.$order||i.options[o].$order;delete i.options[o];i.uncacheValue(r);i.options[r]=t;if(l){if(i.dropdown_content.contains(l)){const e=i._render("option",t);replaceNode(l,e);i.activeOption===l&&i.setActiveOption(e)}l.remove()}if(a){n=i.items.indexOf(o);-1!==n&&i.items.splice(n,1,r);s=i._render("item",t);a.classList.contains("active")&&addClasses(s,"active");replaceNode(a,s)}i.lastQuery=null}removeOption(e,t){const i=this;e=get_hash(e);i.uncacheValue(e);delete i.userOptions[e];delete i.options[e];i.lastQuery=null;i.trigger("option_remove",e);i.removeItem(e,t)}clearOptions(e){const t=(e||this.clearFilter).bind(this);this.loadedSearches={};this.userOptions={};this.clearCache();const i={};iterate(this.options,((e,s)=>{t(e,s)&&(i[s]=this.options[s])}));this.options=this.sifter.items=i;this.lastQuery=null;this.trigger("option_clear")}clearFilter(e,t){return this.items.indexOf(t)>=0}getOption(e,t=false){const i=hash_key(e);if(null!==i&&this.options.hasOwnProperty(i)){const e=this.options[i];if(e.$div)return e.$div;if(t)return this._render("option",e)}return null}getAdjacent(e,t,i="option"){var s,n=this;if(!e)return null;s="item"==i?n.controlChildren():n.dropdown_content.querySelectorAll("[data-selectable]");for(let i=0;i<s.length;i++)if(s[i]==e)return t>0?s[i+1]:s[i-1];return null}getItem(e){if("object"==typeof e)return e;var t=hash_key(e);return null!==t?this.control.querySelector(`[data-value="${addSlashes(t)}"]`):null}addItems(e,t){var i=this;var s=Array.isArray(e)?e:[e];s=s.filter((e=>-1===i.items.indexOf(e)));for(let e=0,n=s.length;e<n;e++){i.isPending=e<n-1;i.addItem(s[e],t)}}addItem(e,t){var i=t?[]:["change","dropdown_close"];debounce_events(this,i,(()=>{var i,s;const n=this;const o=n.settings.mode;const r=hash_key(e);if(r&&-1!==n.items.indexOf(r)){"single"===o&&n.close();if("single"===o||!n.settings.duplicates)return}if(null!==r&&n.options.hasOwnProperty(r)){"single"===o&&n.clear(t);if("multi"!==o||!n.isFull()){i=n._render("item",n.options[r]);n.control.contains(i)&&(i=i.cloneNode(true));s=n.isFull();n.items.splice(n.caretPos,0,r);n.insertAtCaret(i);if(n.isSetup){if(!n.isPending&&n.settings.hideSelected){let e=n.getOption(r);let t=n.getAdjacent(e,1);t&&n.setActiveOption(t)}n.isPending||n.settings.closeAfterSelect||n.refreshOptions(n.isFocused&&"single"!==o);false!=n.settings.closeAfterSelect&&n.isFull()?n.close():n.isPending||n.positionDropdown();n.trigger("item_add",r,i);n.isPending||n.updateOriginalInput({silent:t})}if(!n.isPending||!s&&n.isFull()){n.inputState();n.refreshState()}}}}))}removeItem(e=null,t){const i=this;e=i.getItem(e);if(!e)return;var s,n;const o=e.dataset.value;s=nodeIndex(e);e.remove();if(e.classList.contains("active")){n=i.activeItems.indexOf(e);i.activeItems.splice(n,1);removeClasses(e,"active")}i.items.splice(s,1);i.lastQuery=null;!i.settings.persist&&i.userOptions.hasOwnProperty(o)&&i.removeOption(o,t);s<i.caretPos&&i.setCaret(i.caretPos-1);i.updateOriginalInput({silent:t});i.refreshState();i.positionDropdown();i.trigger("item_remove",o,e)}createItem(e=null,t=true,i=(()=>{})){var s=this;var n=s.caretPos;var o;e=e||s.inputValue();if(!s.canCreate(e)){i();return false}s.lock();var r=false;var create=e=>{s.unlock();if(!e||"object"!==typeof e)return i();var t=hash_key(e[s.settings.valueField]);if("string"!==typeof t)return i();s.setTextboxValue();s.addOption(e,true);s.setCaret(n);s.addItem(t);i(e);r=true};o="function"===typeof s.settings.create?s.settings.create.call(this,e,create):{[s.settings.labelField]:e,[s.settings.valueField]:e};r||create(o);return true}refreshItems(){var e=this;e.lastQuery=null;e.isSetup&&e.addItems(e.items);e.updateOriginalInput();e.refreshState()}refreshState(){const e=this;e.refreshValidityState();const t=e.isFull();const i=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);const s=e.wrapper.classList;s.toggle("focus",e.isFocused);s.toggle("disabled",e.isDisabled);s.toggle("required",e.isRequired);s.toggle("invalid",!e.isValid);s.toggle("locked",i);s.toggle("full",t);s.toggle("input-active",e.isFocused&&!e.isInputHidden);s.toggle("dropdown-active",e.isOpen);s.toggle("has-options",isEmptyObject(e.options));s.toggle("has-items",e.items.length>0)}refreshValidityState(){var e=this;if(e.input.validity){e.isValid=e.input.validity.valid;e.isInvalid=!e.isValid}}
        /**
         * Determines whether or not more items can be added
         * to the control without exceeding the user-defined maximum.
         *
         * @returns {boolean}
         */isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const t=this;var i,s;const n=t.input.querySelector('option[value=""]');if(t.is_select_tag){const o=[];const r=t.input.querySelectorAll("option:checked").length;function AddSelected(e,i,s){e||(e=getDom('<option value="'+escape_html(i)+'">'+escape_html(s)+"</option>"));e!=n&&t.input.append(e);o.push(e);(e!=n||r>0)&&(e.selected=true);return e}t.input.querySelectorAll("option:checked").forEach((e=>{e.selected=false}));0==t.items.length&&"single"==t.settings.mode?AddSelected(n,"",""):t.items.forEach((e=>{i=t.options[e];s=i[t.settings.labelField]||"";if(o.includes(i.$option)){const i=t.input.querySelector(`option[value="${addSlashes(e)}"]:not(:checked)`);AddSelected(i,e,s)}else i.$option=AddSelected(i.$option,e,s)}))}else t.input.value=t.getValue();t.isSetup&&(e.silent||t.trigger("change",t.getValue()))}open(){var e=this;if(!(e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull())){e.isOpen=true;setAttr(e.focus_node,{"aria-expanded":"true"});e.refreshState();applyCSS(e.dropdown,{visibility:"hidden",display:"block"});e.positionDropdown();applyCSS(e.dropdown,{visibility:"visible",display:"block"});e.focus();e.trigger("dropdown_open",e.dropdown)}}close(e=true){var t=this;var i=t.isOpen;if(e){t.setTextboxValue();"single"===t.settings.mode&&t.items.length&&t.hideInput()}t.isOpen=false;setAttr(t.focus_node,{"aria-expanded":"false"});applyCSS(t.dropdown,{display:"none"});t.settings.hideSelected&&t.clearActiveOption();t.refreshState();i&&t.trigger("dropdown_close",t.dropdown)}positionDropdown(){if("body"===this.settings.dropdownParent){var e=this.control;var t=e.getBoundingClientRect();var i=e.offsetHeight+t.top+window.scrollY;var s=t.left+window.scrollX;applyCSS(this.dropdown,{width:t.width+"px",top:i+"px",left:s+"px"})}}clear(e){var t=this;if(t.items.length){var i=t.controlChildren();iterate(i,(e=>{t.removeItem(e,true)}));t.showInput();e||t.updateOriginalInput();t.trigger("clear")}}insertAtCaret(e){const t=this;const i=t.caretPos;const s=t.control;s.insertBefore(e,s.children[i]);t.setCaret(i+1)}deleteSelection(e){var t,i,s,n;var o=this;t=e&&e.keyCode===f?-1:1;i=getSelection(o.control_input);const r=[];if(o.activeItems.length){n=getTail(o.activeItems,t);s=nodeIndex(n);t>0&&s++;iterate(o.activeItems,(e=>r.push(e)))}else if((o.isFocused||"single"===o.settings.mode)&&o.items.length){const e=o.controlChildren();t<0&&0===i.start&&0===i.length?r.push(e[o.caretPos-1]):t>0&&i.start===o.inputValue().length&&r.push(e[o.caretPos])}if(!o.shouldDelete(r,e))return false;preventDefault(e,true);"undefined"!==typeof s&&o.setCaret(s);while(r.length)o.removeItem(r.pop());o.showInput();o.positionDropdown();o.refreshOptions(false);return true}shouldDelete(e,t){const i=e.map((e=>e.dataset.value));return!(!i.length||"function"===typeof this.settings.onDelete&&false===this.settings.onDelete(i,t))}advanceSelection(e,t){var i,s,n=this;n.rtl&&(e*=-1);if(!n.inputValue().length)if(isKeyDown(y,t)||isKeyDown("shiftKey",t)){i=n.getLastActive(e);s=i?i.classList.contains("active")?n.getAdjacent(i,e,"item"):i:e>0?n.control_input.nextElementSibling:n.control_input.previousElementSibling;if(s){s.classList.contains("active")&&n.removeActiveItem(i);n.setActiveItemClass(s)}}else n.moveCaret(e)}moveCaret(e){}getLastActive(e){let t=this.control.querySelector(".last-active");if(t)return t;var i=this.control.querySelectorAll(".active");return i?getTail(i,e):void 0}setCaret(e){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.isLocked=true;this.refreshState()}unlock(){this.isLocked=false;this.refreshState()}disable(){var e=this;e.input.disabled=true;e.control_input.disabled=true;e.focus_node.tabIndex=-1;e.isDisabled=true;this.close();e.lock()}enable(){var e=this;e.input.disabled=false;e.control_input.disabled=false;e.focus_node.tabIndex=e.tabIndex;e.isDisabled=false;e.unlock()}destroy(){var e=this;var t=e.revertSettings;e.trigger("destroy");e.off();e.wrapper.remove();e.dropdown.remove();e.input.innerHTML=t.innerHTML;e.input.tabIndex=t.tabIndex;removeClasses(e.input,"tomselected","ts-hidden-accessible");e._destroy();delete e.input.tomselect}render(e,t){return"function"!==typeof this.settings.render[e]?null:this._render(e,t)}_render(e,t){var i,s,n="";const o=this;"option"!==e&&"item"!=e||(n=get_hash(t[o.settings.valueField]));s=o.settings.render[e].call(this,t,escape_html);if(null==s)return s;s=getDom(s);if("option"===e||"option_create"===e)t[o.settings.disabledField]?setAttr(s,{"aria-disabled":"true"}):setAttr(s,{"data-selectable":""});else if("optgroup"===e){i=t.group[o.settings.optgroupValueField];setAttr(s,{"data-group":i});t.group[o.settings.disabledField]&&setAttr(s,{"data-disabled":""})}if("option"===e||"item"===e){setAttr(s,{"data-value":n});if("item"===e){addClasses(s,o.settings.itemClass);setAttr(s,{"data-ts-item":""})}else{addClasses(s,o.settings.optionClass);setAttr(s,{role:"option",id:t.$id});o.options[n].$div=s}}return s}clearCache(){iterate(this.options,((e,t)=>{if(e.$div){e.$div.remove();delete e.$div}}))}uncacheValue(e){const t=this.getOption(e);t&&t.remove()}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,t,i){var s=this;var n=s[t];s[t]=function(){var t,o;"after"===e&&(t=n.apply(s,arguments));o=i.apply(s,arguments);if("instead"===e)return o;"before"===e&&(t=n.apply(s,arguments));return t}}}function change_listener(){addEvent((this||e).input,"change",(()=>{this.sync()}))}function checkbox_options(){var t=this||e;var i=t.onOptionSelect;t.settings.hideSelected=false;var s=function UpdateCheckbox(e){setTimeout((()=>{var t=e.querySelector("input");t instanceof HTMLInputElement&&(e.classList.contains("selected")?t.checked=true:t.checked=false)}),1)};t.hook("after","setupTemplates",(()=>{var e=t.settings.render.option;t.settings.render.option=(i,s)=>{var n=getDom(e.call(t,i,s));var o=document.createElement("input");o.addEventListener("click",(function(e){preventDefault(e)}));o.type="checkbox";const r=hash_key(i[t.settings.valueField]);r&&t.items.indexOf(r)>-1&&(o.checked=true);n.prepend(o);return n}}));t.on("item_remove",(e=>{var i=t.getOption(e);if(i){i.classList.remove("selected");s(i)}}));t.on("item_add",(e=>{var i=t.getOption(e);i&&s(i)}));t.hook("instead","onOptionSelect",((e,n)=>{if(n.classList.contains("selected")){n.classList.remove("selected");t.removeItem(n.dataset.value);t.refreshOptions();preventDefault(e,true)}else{i.call(t,e,n);s(n)}}))}function clear_button(t){const i=this||e;const s=Object.assign({className:"clear-button",title:"Clear All",html:e=>`<div class="${e.className}" title="${e.title}">&times;</div>`},t);i.on("initialize",(()=>{var e=getDom(s.html(s));e.addEventListener("click",(e=>{if(!i.isDisabled){i.clear();"single"===i.settings.mode&&i.settings.allowEmptyOption&&i.addItem("");e.preventDefault();e.stopPropagation()}}));i.control.appendChild(e)}))}function drag_drop(){var t=this||e;if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===t.settings.mode){var i=t.lock;var s=t.unlock;t.hook("instead","lock",(()=>{var e=$(t.control).data("sortable");e&&e.disable();return i.call(t)}));t.hook("instead","unlock",(()=>{var e=$(t.control).data("sortable");e&&e.enable();return s.call(t)}));t.on("initialize",(()=>{var i=$(t.control).sortable({items:"[data-value]",forcePlaceholderSize:true,disabled:t.isLocked,start:(e,t)=>{t.placeholder.css("width",t.helper.css("width"));i.css({overflow:"visible"})},stop:()=>{i.css({overflow:"hidden"});var s=[];i.children("[data-value]").each((function(){(this||e).dataset.value&&s.push((this||e).dataset.value)}));t.setValue(s)}})}))}}function dropdown_header(t){const i=this||e;const s=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:e=>'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a class="'+e.closeClass+'">&times;</a></div></div>'},t);i.on("initialize",(()=>{var e=getDom(s.html(s));var t=e.querySelector("."+s.closeClass);t&&t.addEventListener("click",(e=>{preventDefault(e,true);i.close()}));i.dropdown.insertBefore(e,i.dropdown.firstChild)}))}function caret_position(){var t=this||e;t.hook("instead","setCaret",(e=>{if("single"!==t.settings.mode&&t.control.contains(t.control_input)){e=Math.max(0,Math.min(t.items.length,e));e==t.caretPos||t.isPending||t.controlChildren().forEach(((i,s)=>{s<e?t.control_input.insertAdjacentElement("beforebegin",i):t.control.appendChild(i)}))}else e=t.items.length;t.caretPos=e}));t.hook("instead","moveCaret",(e=>{if(!t.isFocused)return;const i=t.getLastActive(e);if(i){const s=nodeIndex(i);t.setCaret(e>0?s+1:s);t.setActiveItem();removeClasses(i,"last-active")}else t.setCaret(t.caretPos+e)}))}function dropdown_input(){const t=this||e;t.settings.shouldOpen=true;t.hook("before","setup",(()=>{t.focus_node=t.control;addClasses(t.control_input,"dropdown-input");const e=getDom('<div class="dropdown-input-wrap">');e.append(t.control_input);t.dropdown.insertBefore(e,t.dropdown.firstChild);const i=getDom('<input class="items-placeholder" tabindex="-1" />');i.placeholder=t.settings.placeholder||"";t.control.append(i)}));t.on("initialize",(()=>{t.control_input.addEventListener("keydown",(e=>{switch(e.keyCode){case d:if(t.isOpen){preventDefault(e,true);t.close()}t.clearActiveItems();return;case m:t.focus_node.tabIndex=-1;break}return t.onKeyDown.call(t,e)}));t.on("blur",(()=>{t.focus_node.tabIndex=t.isDisabled?-1:t.tabIndex}));t.on("dropdown_open",(()=>{t.control_input.focus()}));const e=t.onBlur;t.hook("instead","onBlur",(i=>{if(!i||i.relatedTarget!=t.control_input)return e.call(t)}));addEvent(t.control_input,"blur",(()=>t.onBlur()));t.hook("before","close",(()=>{t.isOpen&&t.focus_node.focus({preventScroll:true})}))}))}function input_autogrow(){var t=this||e;t.on("initialize",(()=>{var e=document.createElement("span");var i=t.control_input;e.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ";t.wrapper.appendChild(e);var s=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"];for(const t of s)e.style[t]=i.style[t];var resize=()=>{e.textContent=i.value;i.style.width=e.clientWidth+"px"};resize();t.on("update item_add item_remove",resize);addEvent(i,"input",resize);addEvent(i,"keyup",resize);addEvent(i,"blur",resize);addEvent(i,"update",resize)}))}function no_backspace_delete(){var t=this||e;var i=t.deleteSelection;this.hook("instead","deleteSelection",(e=>!!t.activeItems.length&&i.call(t,e)))}function no_active_items(){this.hook("instead","setActiveItem",(()=>{}));this.hook("instead","selectAll",(()=>{}))}function optgroup_columns(){var t=this||e;var i=t.onKeyDown;t.hook("instead","onKeyDown",(e=>{var s,n,o,r;if(!t.isOpen||!(e.keyCode===u||e.keyCode===h))return i.call(t,e);t.ignoreHover=true;r=parentMatch(t.activeOption,"[data-group]");s=nodeIndex(t.activeOption,"[data-selectable]");if(r){r=e.keyCode===u?r.previousSibling:r.nextSibling;if(r){o=r.querySelectorAll("[data-selectable]");n=o[Math.min(o.length-1,s)];n&&t.setActiveOption(n)}}}))}function remove_button(t){const i=Object.assign({label:"&times;",title:"Remove",className:"remove",append:true},t);var s=this||e;if(i.append){var n='<a href="javascript:void(0)" class="'+i.className+'" tabindex="-1" title="'+escape_html(i.title)+'">'+i.label+"</a>";s.hook("after","setupTemplates",(()=>{var e=s.settings.render.item;s.settings.render.item=(t,i)=>{var o=getDom(e.call(s,t,i));var r=getDom(n);o.appendChild(r);addEvent(r,"mousedown",(e=>{preventDefault(e,true)}));addEvent(r,"click",(e=>{preventDefault(e,true);if(!s.isLocked&&s.shouldDelete([o],e)){s.removeItem(o);s.refreshOptions(false);s.inputState()}}));return o}}))}}function restore_on_backspace(t){const i=this||e;const s=Object.assign({text:e=>e[i.settings.labelField]},t);i.on("item_remove",(function(e){if(i.isFocused&&""===i.control_input.value.trim()){var t=i.options[e];t&&i.setTextboxValue(s.text.call(i,t))}}))}function virtual_scroll(){const t=this||e;const i=t.canLoad;const s=t.clearActiveOption;const n=t.loadCallback;var o={};var r;var l=false;var a;var c=[];t.settings.shouldLoadMore||(t.settings.shouldLoadMore=()=>{const e=r.clientHeight/(r.scrollHeight-r.scrollTop);if(e>.9)return true;if(t.activeOption){var i=t.selectable();var s=[...i].indexOf(t.activeOption);if(s>=i.length-2)return true}return false});if(!t.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";t.settings.sortField=[{field:"$order"},{field:"$score"}];const canLoadMore=e=>!("number"===typeof t.settings.maxOptions&&r.children.length>=t.settings.maxOptions)&&!(!(e in o)||!o[e]);const clearFilter=(e,i)=>t.items.indexOf(i)>=0||c.indexOf(i)>=0;t.setNextUrl=(e,t)=>{o[e]=t};t.getUrl=e=>{if(e in o){const t=o[e];o[e]=false;return t}o={};return t.settings.firstUrl.call(t,e)};t.hook("instead","clearActiveOption",(()=>{if(!l)return s.call(t)}));t.hook("instead","canLoad",(e=>e in o?canLoadMore(e):i.call(t,e)));t.hook("instead","loadCallback",((e,i)=>{l?a&&e.length>0&&(a.dataset.value=e[0][t.settings.valueField]):t.clearOptions(clearFilter);n.call(t,e,i);l=false}));t.hook("after","refreshOptions",(()=>{const e=t.lastValue;var i;if(canLoadMore(e)){i=t.render("loading_more",{query:e});if(i){i.setAttribute("data-selectable","");a=i}}else e in o&&!r.querySelector(".no-results")&&(i=t.render("no_more_results",{query:e}));if(i){addClasses(i,t.settings.optionClass);r.append(i)}}));t.on("initialize",(()=>{c=Object.keys(t.options);r=t.dropdown_content;t.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},t.settings.render);r.addEventListener("scroll",(()=>{if(t.settings.shouldLoadMore.call(t)&&canLoadMore(t.lastValue)&&!l){l=true;t.load.call(t,t.lastValue)}}))}))}TomSelect.define("change_listener",change_listener);TomSelect.define("checkbox_options",checkbox_options);TomSelect.define("clear_button",clear_button);TomSelect.define("drag_drop",drag_drop);TomSelect.define("dropdown_header",dropdown_header);TomSelect.define("caret_position",caret_position);TomSelect.define("dropdown_input",dropdown_input);TomSelect.define("input_autogrow",input_autogrow);TomSelect.define("no_backspace_delete",no_backspace_delete);TomSelect.define("no_active_items",no_active_items);TomSelect.define("optgroup_columns",optgroup_columns);TomSelect.define("remove_button",remove_button);TomSelect.define("restore_on_backspace",restore_on_backspace);TomSelect.define("virtual_scroll",virtual_scroll);return TomSelect}));var i=t;export{i as default};

//# sourceMappingURL=tom-select.complete.js.map